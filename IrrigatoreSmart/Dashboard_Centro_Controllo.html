<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå± Irrigazione Smart DIY ‚Äî Dashboard Centro Controllo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 40px 30px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            margin-bottom: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            color: #2d3748;
            margin-bottom: 10px;
        }

        header .subtitle {
            font-size: 1.2em;
            color: #718096;
            margin-bottom: 20px;
        }

        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .status-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .status-item .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .status-item .value {
            font-size: 1.8em;
            font-weight: bold;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #edf2f7;
        }

        .card-icon {
            font-size: 2.5em;
            margin-right: 15px;
        }

        .card h2 {
            font-size: 1.5em;
            color: #2d3748;
        }

        .card-content {
            margin-bottom: 20px;
        }

        .file-item {
            background: #f7fafc;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-name {
            font-weight: 600;
            color: #2d3748;
            flex: 1;
        }

        .file-size {
            font-size: 0.85em;
            color: #718096;
            margin: 0 10px;
        }

        button,
        .action-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: opacity 0.3s ease;
            font-size: 0.95em;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        button:hover,
        .action-button:hover {
            opacity: 0.9;
        }

        button.secondary,
        .action-button.secondary {
            background: #edf2f7;
            color: #2d3748;
            border: 1px solid #cbd5e0;
        }

        button.secondary:hover,
        .action-button.secondary:hover {
            background: #e2e8f0;
        }

        .action-button.small {
            padding: 8px 14px;
            font-size: 0.85em;
        }

        .action-button.disabled {
            cursor: not-allowed;
            opacity: 0.5;
            pointer-events: none;
        }

        .file-note {
            font-size: 0.85em;
            color: #c53030;
            font-weight: 600;
        }

        .content-viewers {
            margin: 40px 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .viewer-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
        }

        .viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 20px;
            border-bottom: 2px solid #edf2f7;
            padding-bottom: 15px;
        }

        .viewer-header h3 {
            margin-bottom: 5px;
            color: #2d3748;
        }

        .viewer-body {
            flex: 1;
            overflow-y: auto;
        }

        .markdown-body {
            background: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            max-height: 520px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
        }

        .markdown-rendered {
            font-size: 0.95em;
            color: #2d3748;
            line-height: 1.6;
        }

        .markdown-rendered h1,
        .markdown-rendered h2,
        .markdown-rendered h3,
        .markdown-rendered h4 {
            margin: 20px 0 10px;
            color: #1a202c;
        }

        .markdown-rendered h1 { font-size: 1.6em; }
        .markdown-rendered h2 { font-size: 1.4em; border-bottom: 1px solid #e2e8f0; padding-bottom: 5px; }
        .markdown-rendered h3 { font-size: 1.2em; color: #2c5282; }
        .markdown-rendered h4 { font-size: 1.05em; color: #4a5568; }

        .markdown-rendered p {
            margin-bottom: 12px;
        }

        .markdown-rendered ul,
        .markdown-rendered ol {
            padding-left: 20px;
            margin-bottom: 12px;
        }

        .markdown-rendered blockquote {
            border-left: 4px solid #667eea;
            background: #edf2ff;
            padding: 10px 15px;
            border-radius: 6px;
            color: #2a4365;
            margin: 15px 0;
        }

        .markdown-rendered code {
            background: #edf2f7;
            border-radius: 4px;
            padding: 2px 5px;
            font-family: 'Fira Code', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }

        .markdown-rendered pre {
            background: #1a202c;
            color: #e2e8f0;
            padding: 14px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.9em;
        }

        .markdown-rendered pre code {
            background: transparent;
            padding: 0;
        }

        .markdown-rendered table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
            font-size: 0.95em;
        }

        .markdown-rendered table th,
        .markdown-rendered table td {
            border: 1px solid #cbd5e0;
            padding: 8px;
            text-align: left;
        }

        .markdown-rendered table th {
            background: #edf2f7;
        }

        .checklist-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 520px;
            overflow-y: auto;
        }

        .checklist-section {
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 18px;
            background: #fdfdfd;
        }

        .checklist-section h4 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .checklist-subsection {
            margin-top: 15px;
        }

        .checklist-subsection h5 {
            margin: 0 0 8px 0;
            color: #4a5568;
            font-size: 1em;
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }

        .todo-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 6px 0;
            border-bottom: 1px solid #edf2f7;
        }

        .todo-item:last-child {
            border-bottom: none;
        }

        .todo-item input {
            margin-top: 4px;
        }

        .todo-item span {
            font-size: 0.95em;
            color: #2d3748;
        }

        .todo-item small {
            display: block;
            color: #718096;
            margin-top: 4px;
        }

        .todo-note {
            margin-left: 26px;
            font-size: 0.85em;
            color: #718096;
            padding: 4px 0;
        }

        .markdown-rendered .mermaid {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 10px;
            padding: 10px;
            margin: 20px 0;
            box-shadow: inset 0 1px 4px rgba(0,0,0,0.08);
        }

        .checklist {
            list-style: none;
        }

        .checklist li {
            padding: 10px;
            background: #f7fafc;
            margin-bottom: 8px;
            border-radius: 6px;
            display: flex;
            align-items: center;
        }

        .checklist li:before {
            content: "‚òê";
            margin-right: 10px;
            color: #667eea;
            font-size: 1.2em;
        }

        .warning-box {
            background: #fff5f5;
            border-left: 4px solid #fc8181;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .warning-box strong {
            color: #c53030;
        }

        .success-box {
            background: #f0fff4;
            border-left: 4px solid #9ae6b4;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .success-box strong {
            color: #22543d;
        }

        .timeline {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .timeline-item {
            display: flex;
            gap: 15px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 6px;
        }

        .timeline-dot {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        .timeline-content h4 {
            margin: 0 0 5px 0;
            color: #2d3748;
        }

        .timeline-content p {
            margin: 0;
            color: #718096;
            font-size: 0.95em;
        }

        footer {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            color: #718096;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .grid-2 {
                grid-template-columns: 1fr;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .content-viewers {
                grid-template-columns: 1fr;
            }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #718096;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #2d3748;
        }

        code {
            background: #f7fafc;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Courier New', monospace;
            color: #c53030;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <header>
            <h1>üå± Irrigazione Smart DIY 24 VAC</h1>
            <p class="subtitle">Dashboard Centro Controllo ‚Äî Progetto Completo</p>
            <div class="status-bar">
                <div class="status-item">
                    <div class="label">File Totali</div>
                    <div class="value">7</div>
                </div>
                <div class="status-item">
                    <div class="label">Budget Base</div>
                    <div class="value">‚Ç¨156</div>
                </div>
                <div class="status-item">
                    <div class="label">Timeline</div>
                    <div class="value">2-3 sett</div>
                </div>
                <div class="status-item">
                    <div class="label">Versione</div>
                    <div class="value">1.0</div>
                </div>
            </div>
        </header>

        <!-- MAIN DASHBOARD -->
        <div class="dashboard">

            <!-- CARD 1: DOWNLOAD TUTTI I FILE -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üì•</div>
                    <h2>Scarica Tutti i File</h2>
                </div>
                <div class="card-content">
                    <p style="margin-bottom: 15px; color: #718096;">Clicca il pulsante per scaricare il pacchetto completo (7 file .zip) o singoli file qui sotto:</p>

                    <a href="Pacchetto_Completo_IrrigatoreSmart.zip" class="action-button" download style="width: 100%; padding: 15px; font-size: 1.1em; margin-bottom: 20px;">
                        ‚¨áÔ∏è SCARICA TUTTO (.ZIP)
                    </a>

                    <div class="file-item">
                        <span class="file-name">üìä BOM_Irrigazione_24VAC_DIY.xlsx</span>
                        <a class="action-button small" href="BOM_Irrigazione_24VAC_DIY.xlsx" download>SCARICA</a>
                    </div>
                    <div class="file-item">
                        <span class="file-name">üìñ Guida_Tecnica_DIY.md</span>
                        <a class="action-button small" href="Guida_Tecnica.html">APRI PAGINA</a>
                    </div>
                    <div class="file-item">
                        <span class="file-name">üíª Codice_Arduino_Completo.ino</span>
                        <a class="action-button small" href="Codice_Arduino_Completo.ino" download>SCARICA</a>
                    </div>
                    <div class="file-item">
                        <span class="file-name">‚úÖ Checklist_Finale_Verifica.md</span>
                        <a class="action-button small" href="#viewer-checklist">VISUALIZZA</a>
                    </div>
                    <div class="file-item">
                        <span class="file-name">üìã INDICE_GENERALE_DELIVERABLE.txt</span>
                        <a class="action-button small" href="INDICE_GENERALE_DELIVERABLE.txt" download>SCARICA</a>
                    </div>
                    <div class="file-item">
                        <span class="file-name">üìä Costi_Progetto_Riepilogo.csv</span>
                        <a class="action-button small" href="Costi_Progetto_Riepilogo.csv" download>SCARICA</a>
                    </div>
                </div>
            </div>

            <!-- CARD 2: QUICK START -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üöÄ</div>
                    <h2>Quick Start ‚Äî 10 Step</h2>
                </div>
                <div class="card-content">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-dot">1</div>
                            <div class="timeline-content">
                                <h4>Scarica i file</h4>
                                <p>Clicca sopra per scaricare tutto</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">2</div>
                            <div class="timeline-content">
                                <h4>Apri Guida Tecnica</h4>
                                <p>Intro + sicurezza direttamente nella pagina</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">3</div>
                            <div class="timeline-content">
                                <h4>Segui Checklist Pre-ordine</h4>
                                <p>Spunta i componenti indispensabili</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">4</div>
                            <div class="timeline-content">
                                <h4>Apri BOM Excel</h4>
                                <p>30 minuti ‚Äî ordina LOTTO 1-3</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">5</div>
                            <div class="timeline-content">
                                <h4>Attendi componenti</h4>
                                <p>5-7 giorni (Amazon) o 16-36 (AliExpress)</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">6</div>
                            <div class="timeline-content">
                                <h4>Montaggio hardware</h4>
                                <p>2-3 giorni ‚Äî segui checklist passo-passo</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">7</div>
                            <div class="timeline-content">
                                <h4>Test intermedi (5 test)</h4>
                                <p>5-7 giorni ‚Äî isolamento, rel√®, sensori, valvole</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">8</div>
                            <div class="timeline-content">
                                <h4>Carica codice Arduino</h4>
                                <p>1 giorno ‚Äî compilazione e upload</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">9</div>
                            <div class="timeline-content">
                                <h4>Calibra sensori</h4>
                                <p>1 giorno ‚Äî ADC_DRY e ADC_WET nel TUO terreno</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot">10</div>
                            <div class="timeline-content">
                                <h4>Operativo! üå±üíß</h4>
                                <p>Sistema live 24/7 ‚Äî ottimizza soglie 1-2 settimane</p>
                            </div>
                        </div>
                    </div>
                </div>
                <button style="width: 100%;" onclick="document.getElementById('modal-checklist').style.display='block'">
                    üìã Vedi checklist completa
                </button>
            </div>

            <!-- CARD 3: BUDGET & COSTI -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üí∞</div>
                    <h2>Budget & Configurazioni</h2>
                </div>
                <div class="card-content">
                    <table style="width: 100%; font-size: 0.95em;">
                        <tr style="background: #f7fafc;">
                            <td style="padding: 8px; font-weight: 600;">Base Uno R3</td>
                            <td style="padding: 8px; text-align: right; color: #667eea; font-weight: 600;">‚Ç¨156</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px;">Base ESP32</td>
                            <td style="padding: 8px; text-align: right; color: #667eea; font-weight: 600;">‚Ç¨152</td>
                        </tr>
                        <tr style="background: #f7fafc;">
                            <td style="padding: 8px;">Full Optional</td>
                            <td style="padding: 8px; text-align: right; color: #667eea; font-weight: 600;">‚Ç¨181</td>
                        </tr>
                        <tr style="border-top: 2px solid #e2e8f0;">
                            <td style="padding: 8px;">+ WiFi Modulo</td>
                            <td style="padding: 8px; text-align: right;">+‚Ç¨15</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px;">+ Display OLED</td>
                            <td style="padding: 8px; text-align: right;">+‚Ç¨4-6</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px;">+ RTC Precisione</td>
                            <td style="padding: 8px; text-align: right;">+‚Ç¨3-4</td>
                        </tr>
                        <tr style="background: #f7fafc;">
                            <td style="padding: 8px;">+ Logging SD</td>
                            <td style="padding: 8px; text-align: right;">+‚Ç¨7</td>
                        </tr>
                    </table>

                    <div class="success-box" style="margin-top: 20px;">
                        <strong>‚úì ROI positivo:</strong> Payback in 1-2 stagioni irrigazione
                        <br>‚úì Risparmio acqua: +30-50% con sensori umidit√†
                        <br>‚úì Open-source: controllo totale, zero vendor lock-in
                    </div>
                </div>
            </div>

            <!-- CARD 4: COMPONENTI CRITICI -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">‚ö†Ô∏è</div>
                    <h2>Componenti & Avvertenze</h2>
                </div>
                <div class="card-content">
                    <div class="warning-box">
                        <strong>üî¥ CRITICO:</strong> Multimetro digitale OBBLIGATORIO per test sicurezza (230V)
                    </div>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">Componenti principali:</h4>
                    <ul class="checklist">
                        <li>Arduino Uno R3 (‚Ç¨22)</li>
                        <li>Rel√® 2ch optoisolato 5V (‚Ç¨3.50)</li>
                        <li>Trasformatore 24VAC 40VA (‚Ç¨28.50)</li>
                        <li>2x Sensori umidit√† capacitivi (‚Ç¨10.40)</li>
                        <li>Box IP65 200√ó300mm (‚Ç¨18.50)</li>
                        <li>Fusibili + Morsetti + Cavi (‚Ç¨10)</li>
                        <li>RCD 30mA (opzionale ma consigliato)</li>
                    </ul>

                    <div class="warning-box" style="margin-top: 15px;">
                        <strong>‚ö†Ô∏è CALIBRAZIONE SENSORI:</strong> Non usare valori di default! Ricalibrare ADC_DRY/ADC_WET nel TUO giardino (terreno diverso = valori diversi)
                    </div>
                </div>
            </div>

            <!-- CARD 5: FILE DETAILS -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üìÑ</div>
                    <h2>Dettagli File</h2>
                </div>
                <div class="card-content">
                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">üìä BOM Excel (4 fogli)</h4>
                    <p style="color: #718096; font-size: 0.95em; margin-bottom: 15px;">BOM_Base: 23 componenti | Optional: 10 upgrade | Totali: calcoli automatici | Note: linee guida acquisto</p>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">üìñ Guida Tecnica (14 sezioni)</h4>
                    <p style="color: #718096; font-size: 0.95em; margin-bottom: 15px;">Sicurezza | Architettura | Componenti | Cablaggio | Montaggio passo-passo | Test | Troubleshooting</p>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">üíª Codice Arduino (400+ righe)</h4>
                    <p style="color: #718096; font-size: 0.95em; margin-bottom: 15px;">Board-agnostico: config.h | hardware_uno.h | hardware_esp32.h | logic.cpp | main_uno.ino | main_esp32.ino</p>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">‚úÖ Checklist (100+ items)</h4>
                    <p style="color: #718096; font-size: 0.95em;">Pre-ordine | Acquisto | Montaggio | Test pre-alimentazione | Test intermedi | Collaudo finale</p>
                </div>
            </div>

            <!-- CARD 6: SUPPORTO & FAQ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üÜò</div>
                    <h2>Supporto & FAQ</h2>
                </div>
                <div class="card-content">
                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">‚ùì Come iniziare?</h4>
                    <p style="color: #718096; font-size: 0.95em; margin-bottom: 15px;">1. Scarica tutti i file | 2. Apri la Guida (Intro + Sicurezza) | 3. Segui la Checklist interattiva | 4. Ordina da BOM Excel</p>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">‚ùì Quanto costa?</h4>
                    <p style="color: #718096; font-size: 0.95em; margin-bottom: 15px;">Base: ‚Ç¨156 (Arduino Uno) | ESP32: ‚Ç¨152 | Full Optional: ‚Ç¨181</p>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">‚ùì Quanto tempo serve?</h4>
                    <p style="color: #718096; font-size: 0.95em; margin-bottom: 15px;">2-3 settimane dalla ordinazione al sistema operativo (5-7 giorni Amazon, 16-36 AliExpress)</p>

                    <h4 style="margin: 15px 0 10px 0; color: #2d3748;">‚ùì Fallback Hunter?</h4>
                    <p style="color: #718096; font-size: 0.95em;">S√å! Deviatore reversibile permette switch rapido "Arduino ‚Üí Hunter" in 5 secondi se Arduino crasha</p>
                </div>
                <button style="width: 100%; margin-top: 15px;" onclick="document.getElementById('modal-faq').style.display='block'">
                    üí° Vedi FAQ completo
                </button>
            </div>

        </div>

        <!-- CHECKLIST VIEWER -->
        <section class="content-viewers">
            <div id="viewer-checklist" class="viewer-card">
                <div class="viewer-header">
                    <div>
                        <h3>‚úÖ Checklist Interattiva</h3>
                        <p style="color: #718096; margin: 0;">Spunta le attivit√† per monitorare l‚Äôavanzamento</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="action-button secondary small" onclick="resetChecklist()">Reset</button>
                        <a class="action-button small" href="Checklist_Finale_Verifica.md" download>DOWNLOAD .MD</a>
                    </div>
                </div>
                <div class="checklist-container viewer-body" id="checklist-content">
                    <p style="color: #718096;">Caricamento checklist...</p>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer>
            <p><strong>Irrigazione Smart DIY v1.0</strong> ‚Äî Dicembre 2025</p>
            <p>Autore: Ingegnere Elettronico Senior + Maker Esperto Irrigazione</p>
            <p>Licenza: Uso privato/educativo ‚Äî Non commerciale</p>
            <p style="margin-top: 15px; opacity: 0.8;">Grazie per aver scelto questo progetto! üå±üíß</p>
        </footer>
    </div>

    <!-- MODALS -->
    <div id="modal-checklist" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('modal-checklist').style.display='none'">&times;</span>
            <h2>üìã Checklist Montaggio Completo</h2>
            <h3>FASE PRE-ORDINE</h3>
            <ul class="checklist">
                <li>Verifica Arduino Uno R3 disponibile (‚Ç¨20-25)</li>
                <li>Verifica Rel√® 2ch optoisolato 5V (SRD-05VDC-SL-C)</li>
                <li>Verifica Trasformatore 24VAC 40VA CE certificato, doppio isolamento</li>
                <li>Verifica 2x Sensori umidit√† capacitivi (non resistivi!)</li>
                <li>Verifica Box IP65 200√ó300mm, guarnizioni neoprene</li>
                <li>Verifica fusibili 20A (primario) e 5A (secondario)</li>
                <li>Verifica RCD 30mA (opzionale ma consigliato)</li>
                <li>Verifica deviatore manuale 2-vie 250VAC 16A</li>
            </ul>
            <h3>FASE MONTAGGIO</h3>
            <ul class="checklist">
                <li>Pulizia box IP65 interna (panno umido asciutto)</li>
                <li>Montaggio DIN rail (allineamento perfetto con livella)</li>
                <li>Montaggio portafusibile primario + fusibile 20A</li>
                <li>Montaggio RCD 30mA (se presente)</li>
                <li>Montaggio trasformatore 24VAC su DIN rail</li>
                <li>Montaggio rel√® 2 canali</li>
                <li>Cablaggio primario 230V (DISCONNETTI SEMPRE SPINA!)</li>
                <li>Cablaggio secondario 24VAC (trasformatore ‚Üí rel√® ‚Üí valvole)</li>
                <li>Collegamento Arduino + sensori umidit√†</li>
                <li>Installazione pressacavi M20 IP67 (2-3 N‚ãÖm, non forzare!)</li>
            </ul>
            <h3>FASE TEST PRE-ALIMENTAZIONE</h3>
            <ul class="checklist">
                <li>Test isolamento: 230V-24VAC &gt;1 MŒ© (multimetro Œ©√ó1000)</li>
                <li>Test continuit√†: cavi L-N primario ‚âà0Œ©</li>
                <li>Test continuit√†: secondario 5-10Œ© (trasformatore OK)</li>
                <li>Test RCD: scatto pulsante TEST (se presente)</li>
                <li>Test fusibili: intatti, non scuriti</li>
            </ul>
            <h3>FASE TEST INTERMEDI</h3>
            <ul class="checklist">
                <li>TEST 1: Alimentazione 230V isolata (no load) ‚Üí 24V AC ¬±5%</li>
                <li>TEST 2: Rel√® meccanico ‚Üí scatto audibile a GPIO 8/9</li>
                <li>TEST 3: Sensori umidit√† ‚Üí calibrazione secca/bagnata (ADC_DRY/WET)</li>
                <li>TEST 4: Ciclo irrigazione completo ‚Üí rel√® attiva valvola, 24V ai morsetti</li>
                <li>TEST 5: Migrazione ESP32 (opzionale) ‚Üí GPIO 4,5,36,39</li>
            </ul>
        </div>
    </div>

    <div id="modal-faq" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('modal-faq').style.display='none'">&times;</span>
            <h2>üí° Domande Frequenti (FAQ)</h2>

            <h3>‚ùì Cosa servono i file?</h3>
            <p><strong>BOM Excel:</strong> Elenco completo componenti con link acquisto Amazon/AliExpress + costi automatici</p>
            <p><strong>Guida Tecnica:</strong> Manuale stampabile 14 sezioni (sicurezza, montaggio, troubleshooting)</p>
            <p><strong>Codice Arduino:</strong> Firmware completo board-agnostico (Uno R3 ‚Üí ESP32 in 1 giorno)</p>
            <p><strong>Checklist:</strong> 100+ checkbox per montaggio, test, calibrazione</p>

            <h3>‚ùì Quale microcontrollore scegliere?</h3>
            <p><strong>Arduino Uno R3:</strong> ‚Ç¨156 base, affidabilit√† 16+anni, learning curve bassa. CONSIGLIATO per primo build.</p>
            <p><strong>ESP32:</strong> ‚Ç¨152 base, WiFi built-in, migrazione in Fase 4 (dopo test Uno funzionante)</p>

            <h3>‚ùì Calibrazione sensori: cosa significa?</h3>
            <p>Ogni terreno √® diverso (argilla, sabbia, torba = diversi valori ADC). OBBLIGATORIO:</p>
            <p>1. Posiziona sensore in suolo SECCO (aria 5 min) ‚Üí annota ADC_DRY</p>
            <p>2. Immergi sensore in ACQUA (30s) ‚Üí annota ADC_WET</p>
            <p>3. Modifica codice con TUOI valori. Se no: letture imprecise al 90%.</p>

            <h3>‚ùì Mi serve multimetro?</h3>
            <p><strong>S√å, OBBLIGATORIO!</strong> Elementi critici:</p>
            <p>‚Ä¢ Test isolamento 230V-24VAC &gt;1 MŒ© (folgorazione?)</p>
            <p>‚Ä¢ Test continuit√† cavi (cortocircuiti?)</p>
            <p>‚Ä¢ Test tensione secondaria 24V ¬±5% (trasformatore OK?)</p>

            <h3>‚ùì Se Arduino crasha, cosa succede?</h3>
            <p>Gira il deviatore reversibile da "Arduino" a "Hunter": sistema Hunter originale riprende il controllo in 5 secondi. Fallback sempre disponibile!</p>

            <h3>‚ùì Posso cominciare senza sapere Arduino?</h3>
            <p>S√å! Codice √® completamente commentato. Learning curve: 1-2 giorni per comprendere flusso.</p>
            <p>Competenza minima richiesta: cablare cavi senza creare cortocircuiti + leggere un multimetro.</p>

            <h3>‚ùì Quanto risparmio d'acqua?</h3>
            <p>Con sensori umidit√†: +30-50% efficienza vs timer fisso. Stima payback: 1-2 stagioni irrigazione.</p>

            <h3>‚ùì Posso aggiungere WiFi dopo?</h3>
            <p>S√å! In Fase 4 migri a ESP32 (‚Ç¨+21 extra). WiFi integrato, logging SD, display OLED tutte possibili.</p>
        </div>
    </div>


    <script type="text/plain" id="inline-checklist">
# ‚úÖ CHECKLIST FINALE DI VERIFICA ‚Äî Progetto Irrigazione DIY

---

## üìã FASE PRE-ORDINE

### Verifica Componenti (Leggi BOM_Base.xlsx prima!)

- [ ] **Arduino Uno R3**: Prezzo ‚Ç¨20-25 (Amazon.it o AliExpress)
  - [ ] Verifica: "Originale" vs "Compatibile" (entrambi OK per DIY)
  - [ ] Board: ATmega328P 16MHz 32kB Flash
  
- [ ] **ESP32 DevKit v1** (acquista in Fase 4, non ora)
  - [ ] Verifica: "DOIT" (modello standard, 30 pin)
  - [ ] Non confondere con ESP8266 o altro (sbagliato!)
  
- [ ] **Rel√® 2 canali optoisolato 5V** (SRD-05VDC-SL-C o equivalente)
  - [ ] Verifica: 5V coil, 10A 250VAC contatti
  - [ ] Isolamento ottico (elemento critico per sicurezza!)
  
- [ ] **Trasformatore 24VAC preassemblato 40VA**
  - [ ] Verifica: 230V input, 24V output, 40VA
  - [ ] Certificazione: CE, IEC 60950, doppio isolamento (Classe II)
  - [ ] Nota: se 50VA disponibile = preferibile (margine maggiore)
  
- [ ] **2x Sensori umidit√† capacitivi**
  - [ ] Modello: DFRobot v1.2 o SEN0193 (non resistivi!)
  - [ ] Verifica: ADC 10-bit, 3.3-5V, scala 0-100%
  
- [ ] **Box IP65 200√ó300√ó150mm**
  - [ ] Verifica: IP65 (polvere+getti), guarnizione neoprene
  - [ ] Pressacavi M20 inclusi (min. 2, meglio 4-5)
  
- [ ] **Fusibili + Portafusibili DIN**
  - [ ] 20A T250V primario (protezione 230V)
  - [ ] 5A T250V secondario (protezione 24VAC)
  - [ ] Portafusibili DIN rail compatible
  
- [ ] **RCD 30mA 2√ó25A** (OPZIONALE ma consigliato)
  - [ ] Verifica: Type AC (non A), 30mA, IEC 61008
  - [ ] Per uso giardino umido = VIVAMENTE consigliato
  
- [ ] **Deviatore manuale 2-vie 250VAC 16A**
  - [ ] Permette switch "Hunter ‚Üî Arduino"
  - [ ] Tipo IEC 60669-1 (standard)
  - [ ] Verifica: isolamento stabile (no usura contatti)
  
- [ ] **Cavi e Cablaggio**
  - [ ] Cavo 1.5mm¬≤ per primario 230V (~5m, rotolo 50m)
  - [ ] Cavo 0.75mm¬≤ per secondario 24VAC (~30m, rotolo 100m)
  - [ ] Tubo isolante: giallo (230V), grigio (24VAC), schermato (sensori)
  - [ ] Morsetti a vite 2-poli 24VAC (min. 4 pezzi)
  - [ ] Morsetti a vite 3-poli 230V (min. 2 pezzi)
  
- [ ] **Connettori e Montaggio**
  - [ ] Pressacavi M20 IP67 (min. 3-4, confezione 5)
  - [ ] Guarnizioni silicone ricambio
  - [ ] Guida DIN 35mm (~40cm necessari, rotolo 2m)
  - [ ] Etichette adesive vinile (cavi, morsetti)
  - [ ] Nastro isolante PVC (20m rotolo)

### Budget Totale Stima

- **Fase 1 (Uno + test)**: ‚Ç¨32-40
- **Fase 2 (sensori)**: ‚Ç¨10-15
- **Fase 3 (trasformatore + protezioni)**: ‚Ç¨60-80
- **Fase 4 (migrazione ESP32, opzionale)**: ‚Ç¨15-25
- **Opzionali (OLED, RTC, Logging)**: ‚Ç¨15-35

**TOTALE MINIMO (Uno): ‚Ç¨100-150**  
**TOTALE COMPLETO (ESP32 + optional): ‚Ç¨180-220**

---

## üì¶ FASE ACQUISTO

- [ ] Ordina in lotti (non tutto insieme per risparmiare spedizione)
  - Lotto 1: Arduino Uno + Rel√® + Alimentatore 5V (3-5 giorni)
  - Lotto 2: Trasformatore + Fusibili + Box IP65 (5-7 giorni)
  - Lotto 3: Sensori + Cavi (dipende da fornitore)
  
- [ ] Verifica compatibilit√† Amazon.it vs AliExpress
  - [ ] Amazon: consegna veloce (2-3 giorni Prime), prezzo +20-30%
  - [ ] AliExpress: prezzo basso, ma 15-30 giorni di attesa
  
- [ ] IMPORTANTE: non ordinare Uno se lo hai gi√†!
  - [ ] Inventario: controlla Arduino in garage/cassetti

---

## üîß FASE PRE-MONTAGGIO

### Preparazione Postazione di Lavoro

- [ ] Area di lavoro asciutta e ben illuminata (niente umidit√†!)
- [ ] Tavolo ampio con **tappeto antistatico** (protezione Arduino ESD)
- [ ] Multimetro digitale a batteria (per test senza contatti pericolosi)
- [ ] Attrezzi:
  - [ ] Cacciavite a croce (piccolo, per morsetti)
  - [ ] Cacciavite piatto (taglio cavi guaina)
  - [ ] Forbici per cavi
  - [ ] Pinza spelacavi 0.75‚Äì1.5mm¬≤
  - [ ] Pinza crimpatrice (opzionale, se usi Wago push-fit)
  - [ ] Chiave dinamometrica ~2 N‚ãÖm (per pressacavi)
  
- [ ] **Verifiche componenti da fare al ricevimento:**
  - [ ] Arduino Uno: LED rosso acceso quando alimentato? (OK)
  - [ ] Rel√®: bottone di test meccanico? (click udibile)
  - [ ] Trasformatore: peso ‚â• 800g? (controllo qualit√†)
  - [ ] Box IP65: guarnizioni integre senza crepe?
  - [ ] Sensori: tre fili integri senza cortocircuiti? (multimetro)

---

## üèóÔ∏è FASE MONTAGGIO

### Step 1: Preparazione Box IP65

- [ ] **Pulizia interna**: panno umido asciutto ‚Üí asciuga completamente
- [ ] **Montaggio DIN rail**: allineamento orizzontale perfetto (livella)
- [ ] **Ispezione guarnizioni**: neoprene integro, no secchezza?
- [ ] **Montaggio staffa Arduino**: fissaggio stabile (vibrazione test)

### Step 2: Montaggio Componenti DIN Rail (IN ORDINE)

1. [ ] **Portafusibile primario 20A**
   - Posizione: sinistra, dopo ingresso trasformatore
   - Azione: inserisci fusibile 20A T250V, test scatto meccanico
   
2. [ ] **RCD 30mA** (se presente)
   - Posizione: centro-sinistra
   - Azione: test button ‚Üí dovrebbe scattare e tornare
   
3. [ ] **Trasformatore 40VA**
   - Posizione: centro-destra DIN rail
   - Azione: verifica fissaggio, no vibrazioni con mano
   - Test: continut√† bobina primaria ~100-500Œ© (multimetro Œ©)
   
4. [ ] **Portafusibile secondario 5A**
   - Posizione: destra trasformatore
   - Azione: inserisci fusibile 5A T250V

### Step 3: Collegamento Cavi Primario 230V

**‚ö†Ô∏è DOPPIA VERIFICAZIONE SICUREZZA**

- [ ] Spegni completamente (scollega presa di corrente dalla parete)
- [ ] **Multimetro**: verifica 0V tra qualunque morsetto di input
  - Se legge tensione: NON PROCEDERE, presa ancora live!
  
- [ ] Cavo rosso (FASE) presa ‚Üí morsetto 1 portafusibile
- [ ] Cavo blu (NEUTRO) presa ‚Üí morsetto N portafusibile
- [ ] Terra giallo/verde (opzionale se classe II): ‚Üí morsetto PE box
  
- [ ] Uscita portafusibile ‚Üí Ingresso RCD L (o diretto trasformatore se no RCD)
- [ ] Neutro presa ‚Üí Ingresso RCD N (o diretto trasformatore)

**Verifica finale primario (spina ancora disconnessa):**
- [ ] Test continuit√† fusibile con multimetro: ~0Œ© (no resistenza)
- [ ] Test isolamento primario-secondario: >1 MŒ© (multimetro Œ©√ó1000)

### Step 4: Collegamento Secondario 24VAC

- [ ] OUT1 trasformatore (L 24VAC) ‚Üí Morsetto L rel√®
- [ ] OUT2 trasformatore (N 24VAC) ‚Üí Morsetto N rel√®
- [ ] Fusibile 5A secondario: inserito in portafusibile
- [ ] Test continuit√† secondario con multimetro: 5-10Œ© (OK)

### Step 5: Collegamento Rel√® a Valvole

- [ ] Rel√® 1 [NO] ‚Üí Valvola Zona 1 ingresso [L/hot]
- [ ] Rel√® 2 [NO] ‚Üí Valvola Zona 2 ingresso [L/hot]
- [ ] Rel√® 1 [COM] + Rel√® 2 [COM] ‚Üí Entrambe valvole [N/return]
  - Nota: COM deve essere unico punto ritorno, no diramazioni multiple!

### Step 6: Collegamento Arduino + Sensori

- [ ] Arduino **GND** ‚Üí Rel√® GND (comune con trasformatore)
- [ ] Arduino **5V** ‚Üí Rel√® VCC + Sensori VCC
- [ ] Arduino **GPIO 8** ‚Üí Rel√® IN1
- [ ] Arduino **GPIO 9** ‚Üí Rel√® IN2
- [ ] Arduino **A0** ‚Üí Sensore Zona 1 OUT
- [ ] Arduino **A1** ‚Üí Sensore Zona 2 OUT
- [ ] Arduino **Alimentazione**: USB 5V/2A esterno (o USB-C computer test)

### Step 7: Installazione Pressacavi M20 IP67

- [ ] Prova a secco (no aperto): inserisci in foro box (dovrebbe resistere)
- [ ] Aggiungi guarnizione silicone extra (doppio sigillo)
- [ ] Serrata leggera con chiave dinamometrica ~2 N‚ãÖm
  - Nota: non forzare! Rischio danno guarnizioni.

---

## ‚ö° FASE TEST PRIMA ALIMENTAZIONE

### Test 1: Isolamento 230V (NO power, multimetro solo)

- [ ] Tra L-N presa: ~230V AC (normale, spina collegata)
- [ ] Tra 230V L e 24VAC L (trasformatore output): >1 MŒ©
  - Se <1 MŒ©: STOP! Trasformatore difettoso, non usare!
- [ ] Tra 230V L e chassis box (terra): >1 MŒ©
- [ ] Tra 230V N e 24VAC L: >1 MŒ© (doppio isolamento ok)

### Test 2: Continuit√† e Cortocircuiti

- [ ] Primario L ‚Üí portafusibile ‚Üí uscita: ~0Œ©
- [ ] Primario N ‚Üí portafusibile ‚Üí uscita: ~0Œ©
- [ ] Secondario L ‚Üî N (acceso, in vuoto): 5-10Œ© (trasformatore OK)
- [ ] Tra 230V L ‚Üî 230V N (multimetro): ‚àûŒ© (no cortocircuito primario)

### Test 3: Accensione RCD (se presente)

- [ ] Collega spina 230V
- [ ] Premi pulsante **TEST** RCD: dovrebbe scattare (interruttore OFF)
- [ ] Premi **RESET**: alimentazione ritorna (interruttore ON)
- [ ] Se non scatta: RCD difettoso, sostituisci e ripeti

### Test 4: Tensione Secondaria (senza carichi)

- [ ] Accendi RCD (interruttore ON)
- [ ] Multimetro AC tra OUT trasformatore:
  - [ ] Dovrebbe leggere **24V ¬± 1V** (tolleranza ¬±5%)
  - [ ] Se 0V: verifica fusibile 20A intatto
  - [ ] Se <22V: possibile trasformatore sovraccarico (collaudo con rel√®)

### Test 5: Arduino Uno Caricamento Sketch

- [ ] Collega Arduino Uno a computer via USB
- [ ] Arduino IDE: seleziona Board "Arduino Uno", Port "COM X"
- [ ] Carica sketch test semplice:
  ```cpp
  void setup() {
    pinMode(8, OUTPUT);
    Serial.begin(9600);
  }
  void loop() {
    digitalWrite(8, LOW);
    Serial.println("LOW");
    delay(1000);
    digitalWrite(8, HIGH);
    Serial.println("HIGH");
    delay(1000);
  }
  ```
- [ ] Apri Serial Monitor (9600 baud)
- [ ] Verifica: messaggio "LOW" e "HIGH" alternato
- [ ] Ascolta GPIO 8: dovrebbe avere "click" meccanico (rel√®)
- [ ] Se no click: verificare continuit√† cavo GPIO 8 ‚Üí Rel√® IN1

### Test 6: Lettura Sensori (no valvole ancora)

- [ ] Carica sketch sensori:
  ```cpp
  void setup() { Serial.begin(9600); }
  void loop() {
    Serial.print(analogRead(A0)); Serial.print(" ");
    Serial.println(analogRead(A1));
    delay(500);
  }
  ```
- [ ] Apri Serial Monitor
- [ ] Letture devono essere:
  - [ ] Sensore secco (aria): 800-900 ADC
  - [ ] Sensore bagnato (acqua): 200-300 ADC
  - [ ] Se invertito o fuori range: verificare calibrazione o sensore difettoso

### Test 7: Ciclo Completo (Uno + Trasformatore + Valvola)

- [ ] Carica sketch completo da "Codice_Arduino_Completo.ino"
- [ ] Accendi spina 230V
- [ ] Serial Monitor: dovrebbe mostrare stato umidit√† + stato valvola
- [ ] Asciuga sensore ‚Üí ADC basso ‚Üí rel√® attiva valvola (click)
- [ ] Bagna sensore ‚Üí ADC alto ‚Üí rel√® spegne valvola (click)
- [ ] Multimetro AC su morsetti valvola: alternare 24V e 0V ‚úì

---

## üîÄ FASE MIGRAZIONE UNO ‚Üí ESP32 (FASE 4)

### Pre-Migrazione Checklist

- [ ] Uno funzionante e testato completamente
- [ ] Arduino IDE: installa supporto ESP32 (Board Manager)
  - Arduino IDE ‚Üí Preferences ‚Üí Additional Boards URLs
  - Aggiungi: `https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json`
  
- [ ] Compra ESP32 DevKit v1 (DOIT, 30-pin)

### Procedura Migrazione Codice

- [ ] **Coppo file identici**:
  - [ ] config.h: identico (nessun cambio)
  - [ ] logic.cpp: identico (nessun cambio)
  
- [ ] **Modifica hardware**:
  - [ ] Sostituisci `#include "hardware_uno.h"`
  - [ ] Con `#include "hardware_esp32.h"`
  - [ ] Verifica pin ESP32: GPIO 4, 5 (rel√®), GPIO 36, 39 (sensori)
  
- [ ] **Ricompilazione**:
  - [ ] Arduino IDE: Board "ESP32 Dev Module"
  - [ ] Port: COM della ESP32
  - [ ] Upload speed: 115200
  - [ ] Verifica compilazione OK (no errori)
  
- [ ] **Caricamento e test**:
  - [ ] Carica sketch
  - [ ] Serial Monitor: verificati log startup ESP32
  - [ ] Ripeti Test 1-5 precedenti (identici proceduralmente)
  - [ ] Calibrazione sensori: potrebbe differire leggermente

### Post-Migrazione (Opzionale)

- [ ] Aggiungi WiFi:
  - [ ] Attiva `#define USE_WIFI` in config.h
  - [ ] Modifica ssid/password in hardware_esp32.h
  
- [ ] Aggiungi Display OLED (I2C):
  - [ ] Connetti SDA ‚Üí GPIO 21, SCL ‚Üí GPIO 22 (standard ESP32)
  - [ ] Attiva `#define USE_OLED` e implementa libreria Adafruit
  
- [ ] Logging SD (opzionale):
  - [ ] Modulo microSD reader SPI: CS‚ÜíGPIO 5, MOSI‚ÜíGPIO 23, etc.
  - [ ] Attiva `#define USE_SD` e libreria SD.h

---

## üå± FASE COLLAUDO FINALE

### Test Completo Campo (Sistema Live)

- [ ] Deviatore su "Arduino" (non Hunter!)
- [ ] Accendi 230V
- [ ] Osserva comportamento zona 1:
  - [ ] Sensore secco ‚Üí Valvola 1 accesa (irrigazione attiva)
  - [ ] Sensore bagnato ‚Üí Valvola 1 spenta (riposo)
  - [ ] Transizioni: verificare cooldown (no accensioni frenetiche)
  
- [ ] Osserva zona 2: stesso comportamento
  
- [ ] Test fallback:
  - [ ] Spegni 230V
  - [ ] Deviatore su "Hunter"
  - [ ] Accendi 230V
  - [ ] Verifica Hunter ancora funzionante (timer test)

### Calibrazione Soglie Umidit√† (1-2 settimane)

- [ ] Osserva pattern naturale giardino
- [ ] Regola SOGLIA_ON/OFF se necessario:
  - [ ] Se valvole si accendono troppo spesso: aumenta SOGLIA_ON (es: 35%)
  - [ ] Se piante soffrono secchezza: diminuisci SOGLIA_ON (es: 25%)
  - [ ] Isteresi (SOGLIA_OFF - SOGLIA_ON) ideale: 20-30%
  
- [ ] Annota comportamento in foglio (data, ora, umidit√†, stato)

### Test Sensore Pioggia (Opzionale, Fase 5+)

- [ ] Installazione sensore pioggia: sotto gronda principale
- [ ] Logica: se piove ‚Üí arresta irrigazione per 2-3 ore
- [ ] Verifica con nebulizzatore (simulate rain)

---

## üêõ TROUBLESHOOTING RAPIDO

### Arduino non carica sketch

```
Soluzione:
  1. Verifica Port e Board corretti (Arduino IDE)
  2. Prova porta USB diversa (o altro cavo)
  3. Se ancora no: Arduino difettoso, prova su altro PC
```

### Rel√® non scatta (no click)

```
Soluzione:
  1. Misura 5V tra VCC e GND rel√® (alimentazione OK?)
  2. Misura GPIO 8/9 con multimetro: alterna 0V-5V?
  3. Se GPIO fisso: software issue o pin danneggiato
  4. Se GPIO OK ma rel√® immobile: rel√® guasto, sostituisci
```

### Sensori leggono male (sempre 1023 o sempre 0)

```
Soluzione:
  1. Verifica cavi A0/A1: continuit√† con multimetro
  2. Disconnetti sensore, misura ADC (dovrebbe 0 o 1023)
  3. Se stabile: problema sensore o calibrazione
  4. Ricalibrare: ripeti procedura calibrazione con ADC_DRY/WET nuovi
```

### Valvole si accendono ma acqua non esce

```
Soluzione:
  1. Multimetro AC su morsetti valvola: leggi 24V?
  2. Se no 24V: rel√® difettoso o cavi scollati
  3. Se 24V OK: valvola bloccata meccanicamente
     ‚Üí Spegni, smonta valvola, pulisci sedile e sfera
     ‚Üí Test con pressione d'aria compressa (max 1 bar!)
```

---

## ‚úÖ FIRMA FINALE DI COMPLETAMENTO

Una volta completati TUTTI i test e funzionante nel vostro giardino:

```
Data inizio progetto: ___/___/______
Data completamento: ___/___/______

Arduino (Uno/ESP32): ________________ (modello)
Sensore Zona 1 ADC_DRY: _____ ADC_WET: _____
Sensore Zona 2 ADC_DRY: _____ ADC_WET: _____

Soglia ON: _____% Soglia OFF: _____%

Irriga automaticamente: ‚òê S√å ‚òê NO

Eventuali problemi residui:
_________________________________________
_________________________________________

Firma: ________________ Data: __________
```

---

**CONGRATULAZIONI! üéâ Sistema operativo e monitored.**

Per future espansioni o debugging, consultare sempre:
1. Guida Tecnica (troubleshooting section)
2. Codice Arduino (commenti dettagliati)
3. BOM (componenti equivalenti e alternative)

    </script>

    <script>
        const CHECKLIST_FILE = 'Checklist_Finale_Verifica.md';

        document.addEventListener('DOMContentLoaded', () => {
            loadChecklist();
        });

        function loadChecklist() {
            const container = document.getElementById('checklist-content');
            if (!container) return;
            container.innerHTML = '<p style="color:#718096;">Caricamento checklist...</p>';

            loadTextResource(CHECKLIST_FILE, 'inline-checklist')
                .then(text => renderChecklist(text, container))
                .catch(err => {
                    container.innerHTML = `<p class="file-note">Errore caricamento: ${err.message || err}</p>`;
                });
        }

        function loadTextResource(file, fallbackId) {
            const inlineElement = fallbackId ? document.getElementById(fallbackId) : null;
            const shouldUseInline = window.location.protocol === 'file:';

            if (!shouldUseInline && file) {
                return fetch(file)
                    .then(response => {
                        if (!response.ok) throw new Error('File non trovato');
                        return response.text();
                    })
                    .catch(err => {
                        if (inlineElement) return inlineElement.textContent;
                        throw err;
                    });
            }

            if (inlineElement) {
                return Promise.resolve(inlineElement.textContent);
            }

            if (file) {
                return fetch(file).then(response => {
                    if (!response.ok) throw new Error('File non trovato');
                    return response.text();
                });
            }

            return Promise.reject(new Error('Risorsa non disponibile'));
        }

        function renderChecklist(text, container) {
            container.innerHTML = '';
            let currentSection = null;
            let currentSubsection = null;

            text.split(/\r?\n/).forEach(line => {
                const trimmed = line.trim();

                if (!trimmed) {
                    return;
                }

                if (/^(-{3,}|\*{3,})$/.test(trimmed)) {
                    return;
                }

                if (trimmed.startsWith('# ')) {
                    return;
                }

                if (trimmed.startsWith('## ')) {
                    currentSection = document.createElement('div');
                    currentSection.className = 'checklist-section';
                    const title = document.createElement('h4');
                    title.textContent = trimmed.replace(/^##\s*/, '');
                    currentSection.appendChild(title);
                    container.appendChild(currentSection);
                    currentSubsection = null;
                    return;
                }

                if (trimmed.startsWith('### ')) {
                    if (!currentSection) {
                        currentSection = document.createElement('div');
                        currentSection.className = 'checklist-section';
                        container.appendChild(currentSection);
                    }
                    currentSubsection = document.createElement('div');
                    currentSubsection.className = 'checklist-subsection';
                    const title = document.createElement('h5');
                    title.textContent = trimmed.replace(/^###\s*/, '');
                    currentSubsection.appendChild(title);
                    currentSection.appendChild(currentSubsection);
                    return;
                }

                const checkboxMatch = line.match(/^\s*(?:-|\d+\.) \[ \] (.+)$/);
                if (checkboxMatch) {
                    const target = currentSubsection || currentSection || container;
                    const item = document.createElement('label');
                    item.className = 'todo-item';
                    const indentLevel = Math.floor(line.match(/^\s*/)[0].length / 2);
                    if (indentLevel > 0) {
                        item.style.marginLeft = `${indentLevel * 12}px`;
                    }
                    const input = document.createElement('input');
                    input.type = 'checkbox';
                    const span = document.createElement('span');
                    span.innerHTML = formatInline(checkboxMatch[1]);
                    item.appendChild(input);
                    item.appendChild(span);
                    target.appendChild(item);
                    return;
                }

                if (/^\s*-\s*Nota:/i.test(line)) {
                    const note = document.createElement('div');
                    note.className = 'todo-note';
                    note.innerHTML = formatInline(line.trim().replace(/^-+\s*/i, ''));
                    (currentSubsection || currentSection || container).appendChild(note);
                    return;
                }

                const paragraph = document.createElement('p');
                paragraph.style.color = '#4a5568';
                paragraph.style.fontSize = '0.9em';
                paragraph.style.margin = '8px 0';
                paragraph.innerHTML = formatInline(trimmed);
                (currentSubsection || currentSection || container).appendChild(paragraph);
            });
        }

        function formatInline(text) {
            return escapeHtml(text)
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/`([^`]+)`/g, '<code>$1</code>');
        }

        function escapeHtml(str) {
            const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;' };
            return str.replace(/[&<>]/g, ch => map[ch] || ch);
        }

        function resetChecklist() {
            document.querySelectorAll('#checklist-content input[type="checkbox"]').forEach(input => {
                input.checked = false;
            });
        }

        // Chiude i modali quando l'utente clicca fuori dal contenuto
        window.onclick = function(event) {
            let modal1 = document.getElementById('modal-checklist');
            let modal2 = document.getElementById('modal-faq');
            if (event.target == modal1) modal1.style.display = 'none';
            if (event.target == modal2) modal2.style.display = 'none';
        }
    </script>
</body>
</html>
